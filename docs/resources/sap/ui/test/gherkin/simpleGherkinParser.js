/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.sjax","sap/ui/thirdparty/jquery"],function(a,r){"use strict";var e={parse:function(a){if(r.type(a)!=="string"){throw new Error("simpleGherkinParser.parse: parameter 'sText' must be a valid string")}var e=a.split("\n").map(function(a){return a.replace(/^\s*#.*/,"").trim()});var t=null,n=null,i=null,s=[],u=[],p=[];for(var c=0;c<e.length;++c){var o=e[c];var m=!!o.match(/^(?:@[^ @]+)(?:\s+@[^ @]+)*$/);if(m){s=o.split(/\s+/);continue}var l=o.match(/^Feature:(.+)$/);if(l){u=s;t={tags:u,name:l[1].trim(),scenarios:[]};s=[];continue}var h=!!o.match(/^Background:/);if(h){n=t.background={name:"<background>",steps:[]};continue}var f=o.match(/^Scenario Outline:(.+)/);var d=o.match(/^Scenario:(.+)/)||f;if(d){p=u.concat(s);n={tags:p,name:d[1].trim(),steps:[]};if(f){n.examples=[]}t.scenarios.push(n);s=[];continue}var v=o.match(/^(Given|When|Then|And|But|\*)\s+(.+)$/);if(v){i={text:v[2].trim(),keyword:v[1].trim()};n.steps.push(i);continue}var g=o.match(/^Examples:(.+)?/);if(g){n.examples.push({tags:p.concat(s),name:g[1]?g[1].trim():"",data:[]});s=[];continue}var x=o.match(/^\|(.*)\|$/);if(x){var y=x[1].split("|").map(function(a){return a.trim()});if(y.length===1){y=y[0]}if(n.examples){n.examples[n.examples.length-1].data.push(y);continue}i.data=i.data||[];i.data.push(y)}}t.scenarios.forEach(function(a){a.steps.forEach(function(a){if(r.isArray(a.data)&&a.data.length===1&&r.type(a.data[0])==="array"){a.data=a.data[0]}})});return t},parseFile:function(e){if(r.type(e)!=="string"){throw new Error("simpleGherkinParser.parseFile: parameter 'sPath' must be a valid string")}e=sap.ui.require.toUrl(e.replace(/\./g,"/"))+".feature";var t=a.sap.sjax({url:e,dataType:"text"});if(!t.success){throw new Error("simpleGherkinParser.parseFile: error loading URL: "+e)}return this.parse(t.data)}};return e},true);