/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define("sap/ui/debug/DebugEnv",["sap/ui/base/Interface","./ControlTree","./LogViewer","./PropertyList","sap/base/Log","sap/ui/thirdparty/jquery"],function(t,i,e,o,s,r){"use strict";var n=function(){};n.prototype.startPlugin=function(t,i){this.oCore=t;this.oWindow=window;try{this.bRunsEmbedded=typeof window.top.testfwk=="undefined";s.info("Starting DebugEnv plugin ("+(this.bRunsEmbedded?"embedded":"testsuite")+")");if(!this.bRunsEmbedded||t.getConfiguration().getInspect()){this.init(i)}if(!this.bRunsEmbedded||t.getConfiguration().getTrace()){this.initLogger(s,i)}}catch(t){s.warning("DebugEnv plugin can not be started outside the Testsuite.")}};n.prototype.stopPlugin=function(){s.info("Stopping DebugEnv plugin.");this.oCore=null};n.prototype.init=function(t){this.oControlTreeWindow=this.bRunsEmbedded?this.oWindow:top.frames["sap-ui-ControlTreeWindow"]||top;this.oPropertyListWindow=this.bRunsEmbedded?this.oWindow:top.frames["sap-ui-PropertyListWindow"]||top;var e=sap.ui.getCore().getConfiguration().getRTL();var s=this.oControlTreeWindow.document.getElementById("sap-ui-ControlTreeRoot"),n=this.oPropertyListWindow.document.getElementById("sap-ui-PropertyWindowRoot");if(!s){s=this.oControlTreeWindow.document.createElement("DIV");s.setAttribute("id","sap-ui-ControlTreeRoot");s.setAttribute("tabindex",-1);s.style.position="absolute";s.style.fontFamily="Arial";s.style.fontSize="8pt";s.style.backgroundColor="white";s.style.color="black";s.style.border="1px solid gray";s.style.overflow="auto";s.style.zIndex="999999";s.style.top="1px";if(e){s.style.left="1px"}else{s.style.right="1px"}s.style.height="49%";s.style.width="200px";this.oControlTreeWindow.document.body.appendChild(s)}else{s.innerHTML=""}this.oControlTreeRoot=s;if(!n){n=this.oPropertyListWindow.document.createElement("DIV");n.setAttribute("id","sap-ui-PropertyWindowRoot");n.setAttribute("tabindex",-1);n.style.position="absolute";n.style.fontFamily="Arial";n.style.fontSize="8pt";n.style.backgroundColor="white";n.style.color="black";n.style.border="1px solid gray";n.style.overflow="auto";n.style.zIndex="99999";n.style.width="196px";n.style.height="49%";if(e){n.style.left="1px"}else{n.style.right="1px"}n.style.bottom="1px";this.oPropertyListWindow.document.body.appendChild(n)}else{n.innerHTML=""}this.oPropertyWindowRoot=n;this.oControlTree=new i(this.oCore,this.oWindow,s,this.bRunsEmbedded);this.oPropertyList=new o(this.oCore,this.oWindow,n);this.oControlTree.attachEvent(i.M_EVENTS.SELECT,this.oPropertyList.update,this.oPropertyList);if(!t){this.oControlTree.renderDelayed()}r(window).unload(r.proxy(function(t){this.oControlTree.exit();this.oPropertyList.exit()},this))};n.prototype.initLogger=function(t,i){this.oLogger=t;this.oLogger.setLogEntriesLimit(Infinity);if(!this.bRunsEmbedded){this.oTraceWindow=top.frames["sap-ui-TraceWindow"];this.oTraceViewer=this.oTraceWindow.oLogViewer=new e(this.oTraceWindow,"sap-ui-TraceWindowRoot");this.oTraceViewer.sLogEntryClassPrefix="lvl";this.oTraceViewer.lock()}else{this.oTraceWindow=this.oWindow;this.oTraceViewer=new e(this.oTraceWindow,"sap-ui-TraceWindowRoot")}this.oLogger.addLogListener(this.oTraceViewer);this.oCore.attachUIUpdated(this.enableLogViewer,this);if(!i){var o=this;this.oTimer=setTimeout(function(){o.enableLogViewer()},0)}};n.prototype.enableLogViewer=function(){if(this.oTimer){clearTimeout(this.oTimer);this.oTimer=undefined}this.oCore.detachUIUpdated(this.enableLogViewer,this);if(this.oTraceViewer){this.oTraceViewer.unlock()}};n.prototype.isRunningEmbedded=function(){return this.bRunsEmbedded};n.prototype.isControlTreeShown=function(){return r(this.oControlTreeRoot).css("visibility")==="visible"||r(this.oControlTreeRoot).css("visibility")==="inherit"};n.prototype.showControlTree=function(){if(!this.oControlTreeRoot){this.init(false)}r(this.oControlTreeRoot).css("visibility","visible")};n.prototype.hideControlTree=function(){r(this.oControlTreeRoot).css("visibility","hidden")};n.prototype.isTraceWindowShown=function(){var t=this.oTraceWindow&&this.oTraceWindow.document.getElementById("sap-ui-TraceWindowRoot");return t&&(r(t).css("visibility")==="visible"||r(t).css("visibility")==="inherit")};n.prototype.showTraceWindow=function(){if(!this.oTraceWindow){this.initLogger(s,false)}var t=this.oTraceWindow&&this.oTraceWindow.document.getElementById("sap-ui-TraceWindowRoot");if(t){r(t).css("visibility","visible")}};n.prototype.hideTraceWindow=function(){var t=this.oTraceWindow&&this.oTraceWindow.document.getElementById("sap-ui-TraceWindowRoot");if(t){r(t).css("visibility","hidden")}};n.prototype.isPropertyListShown=function(){return r(this.oPropertyWindowRoot).css("visibility")==="visible"||r(this.oPropertyWindowRoot).css("visibility")==="inherit"};n.prototype.showPropertyList=function(){if(!this.oPropertyWindowRoot){this.init(false)}r(this.oPropertyWindowRoot).css("visibility","visible")};n.prototype.hidePropertyList=function(){r(this.oPropertyWindowRoot).css("visibility","hidden")};(function(){var i=new n;sap.ui.getCore().registerPlugin(i);var e=new t(i,["isRunningEmbedded","isControlTreeShown","showControlTree","hideControlTree","isTraceWindowShown","showTraceWindow","hideTraceWindow","isPropertyListShown","showPropertyList","hidePropertyList"]);n.getInstance=function(){return e}})();return n},true);