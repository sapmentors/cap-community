/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/changeHandler/Base","sap/ui/core/util/reflection/JsControlTreeModifier","sap/base/Log","sap/ui/thirdparty/jquery"],function(e,t,r,o){"use strict";var n={};n.applyChange=function(t,n,a){var i=a.modifier,p=a.appComponent,l=a.view,c=t.getDefinition(),u,s;if(c.texts&&c.texts.groupLabel&&c.texts.groupLabel.value&&c.content&&c.content.group&&(c.content.group.selector||c.content.group.id)){var g=c.texts.groupLabel.value,f=c.content.group.index,d=c.content.group.selector||{id:c.content.group.id},C=o.extend({},d);C.id=C.id+"--title";t.setRevertData({newGroupSelector:d});if(i.bySelector(C,p)){return e.markAsNotApplicable("Control to be created already exists:"+C)}else if(i.bySelector(d,p)){return e.markAsNotApplicable("Control to be created already exists:"+d)}u=i.createControl("sap.ui.core.Title",p,l,C);s=i.createControl("sap.ui.layout.form.FormContainer",p,l,d);i.setProperty(u,"text",g);i.insertAggregation(s,"title",u,0,l);i.insertAggregation(n,"formContainers",s,f,l)}else{r.error("Change does not contain sufficient information to be applied: ["+c.layer+"]"+c.namespace+"/"+c.fileName+"."+c.fileType)}};n.completeChangeContent=function(r,o,n){var a=r.getDefinition(),i=n.appComponent;if(o.newLabel){e.setTextInChange(a,"groupLabel",o.newLabel,"XFLD")}else{throw new Error("Cannot create a new group: oSpecificChangeInfo.groupLabel attribute required")}if(!a.content){a.content={}}if(!a.content.group){a.content.group={}}if(o.index===undefined){throw new Error("Cannot create a new group: oSpecificChangeInfo.index attribute required")}else{a.content.group.index=o.index}if(o.newControlId){a.content.group.selector=t.getSelector(o.newControlId,i)}else{throw new Error("Cannot create a new group: oSpecificChangeInfo.newControlId attribute required")}};n.revertChange=function(e,t,r){var o=r.appComponent;var n=r.view;var a=r.modifier;var i=e.getRevertData().newGroupSelector;var p=a.bySelector(i,o,n);a.removeAggregation(t,"formContainers",p);a.destroy(p);e.resetRevertData()};return n},true);