/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/format/DateFormat","sap/ui/model/SimpleType","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/thirdparty/jquery","sap/base/util/isEmptyObject"],function(t,e,o,r,a,i,s){"use strict";var n=e.extend("sap.ui.model.type.Date",{constructor:function(){e.apply(this,arguments);this.sName="Date"}});n.prototype.formatValue=function(t,e){var r;switch(this.getPrimitiveType(e)){case"string":case"any":if(t==null){return""}if(this.oFormatOptions.source&&this.oFormatOptions.source.pattern!=="timestamp"&&t===""){return""}r=this.getModelFormat();t=r.parse(t);return this.oOutputFormat.format(t);default:throw new o("Don't know how to format Date to "+e)}};n.prototype.parseValue=function(t,e){var o,a;switch(this.getPrimitiveType(e)){case"string":if(t===""){return null}var o=this.oOutputFormat.parse(t);if(!o){a=sap.ui.getCore().getLibraryResourceBundle();throw new r(a.getText(this.sName+".Invalid"))}if(this.oInputFormat){if(this.oFormatOptions.source.pattern=="timestamp"){o=o.getTime()}else{o=this.oInputFormat.format(o)}}return o;default:throw new r("Don't know how to parse Date from "+e)}};n.prototype.validateValue=function(t){if(this.oConstraints){var e=sap.ui.getCore().getLibraryResourceBundle(),o=[],r=[],s=this.oInputFormat,n,p=this;if(s&&this.oFormatOptions.source.pattern!="timestamp"){t=s.parse(t)}i.each(this.oConstraints,function(a,i){if(s){i=s.parse(i)}n=p.oOutputFormat.format(i);switch(a){case"minimum":if(t<i){o.push("minimum");r.push(e.getText(p.sName+".Minimum",[n]))}break;case"maximum":if(t>i){o.push("maximum");r.push(e.getText(p.sName+".Maximum",[n]))}break}});if(o.length>0){throw new a(this.combineMessages(r),o)}}};var p={format:function(t){if(t instanceof Date){return t.getTime()}return null},parse:function(t){if(typeof t!="number"){if(isNaN(t)){throw new o("Cannot format date: "+t+" is not a valid Timestamp")}else{t=parseInt(t)}}t=new Date(t);return t}};n.prototype.getModelFormat=function(){if(this.oInputFormat){if(this.oFormatOptions.source.pattern=="timestamp"){return p}else{return this.oInputFormat}}else{return e.prototype.getModelFormat.call(this)}};n.prototype.setFormatOptions=function(t){this.oFormatOptions=t;this._createFormats()};n.prototype.getOutputPattern=function(){return this.oOutputFormat.oFormatOptions.pattern};n.prototype._handleLocalizationChange=function(){this._createFormats()};n.prototype._createFormats=function(){var e=this.oFormatOptions.source;this.oOutputFormat=t.getInstance(this.oFormatOptions);if(e){if(s(e)){e={pattern:"yyyy-MM-dd"}}this.oInputFormat=t.getInstance(e)}};return n});