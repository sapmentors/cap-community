/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","sap/ui/core/ValueStateSupport","sap/ui/core/library","./ProgressIndicatorRenderer","sap/base/Log"],function(e,t,a,r,i,s){"use strict";var l=r.TextDirection;var n=r.ValueState;var u=t.extend("sap.m.ProgressIndicator",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.m",properties:{enabled:{type:"boolean",group:"Behavior",defaultValue:true},state:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:n.None},displayValue:{type:"string",group:"Appearance",defaultValue:null},percentValue:{type:"float",group:"Data",defaultValue:0},showValue:{type:"boolean",group:"Appearance",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:l.Inherit},displayOnly:{type:"boolean",group:"Behavior",defaultValue:false},displayAnimation:{type:"boolean",group:"Behavior",defaultValue:true}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},designtime:"sap/m/designtime/ProgressIndicator.designtime"}});var o=sap.ui.getCore().getConfiguration().getAnimation();u.prototype.setPercentValue=function(e){var t=this,a,r,i=this.$(),l,n=e;e=parseFloat(e);if(!p(e)){if(e>100){e=100}else if(e<0){e=0}else{s.warning(this+": percentValue ("+n+") is not a valid number! The provided value will not be set!");return this}s.warning(this+": percentValue ("+n+") is not correct! Setting the percentValue to "+e)}if(this.getPercentValue()!==e){r=this.getPercentValue()-e;this.setProperty("percentValue",e,true);if(!i.length){return this}["sapMPIValueMax","sapMPIValueMin","sapMPIValueNormal","sapMPIValueGreaterHalf"].forEach(function(e){i.removeClass(e)});i.addClass(this._getCSSClassByPercentValue(e).join(" "));i.addClass("sapMPIAnimate").attr("aria-valuenow",e).attr("aria-valuetext",this._getAriaValueText({fPercent:e}));l=o&&this.getDisplayAnimation()?Math.abs(r)*20:0;a=this.$("bar");a.stop();a.animate({"flex-basis":e+"%"},l,"linear",function(){t._setText.apply(t);t.$().removeClass("sapMPIAnimate")})}return this};u.prototype._setText=function(){this.$().toggleClass("sapMPIValueGreaterHalf",this.getPercentValue()>50);return this};u.prototype._getCSSClassByPercentValue=function(e){if(e===100){return["sapMPIValueMax","sapMPIValueGreaterHalf"]}if(e===0){return["sapMPIValueMin"]}if(e<=50){return["sapMPIValueNormal"]}return["sapMPIValueNormal","sapMPIValueGreaterHalf"]};u.prototype._getAriaValueText=function(e){e.sText=e.sText||this.getDisplayValue();e.fPercent=e.fPercent||this.getPercentValue();e.sStateText=e.sStateText||this._getStateText();var t=e.sText||e.fPercent+"%";if(e.sStateText){t+=" "+e.sStateText}return t};u.prototype._getStateText=function(){return a.getAdditionalText(this.getState())};u.prototype.getAccessibilityInfo=function(){var e=sap.ui.getCore().getLibraryResourceBundle("sap.m"),t=this.getDisplayValue(),a=t?t:e.getText("ACC_CTR_STATE_PROGRESS",[this.getPercentValue()]);return{role:"progressbar",type:e.getText("ACC_CTR_TYPE_PROGRESS"),description:a,focusable:this.getEnabled(),enabled:this.getEnabled()}};function p(e){return!isNaN(e)&&e>=0&&e<=100}return u});