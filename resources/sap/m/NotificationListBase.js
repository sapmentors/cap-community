/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Core","sap/ui/core/Control","sap/ui/core/Element","sap/ui/Device","./ListItemBase","./Text","./Image","./Button","./ToolbarSeparator","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/ui/core/IconPool","sap/ui/core/Icon","sap/ui/core/library"],function(t,e,o,r,i,s,n,a,l,u,p,f,h,c,y){"use strict";var g=y.Priority;var v=t.ButtonType;var d=t.OverflowToolbarPriority;var w=e.getLibraryResourceBundle("sap.m"),B=w.getText("NOTIFICATION_LIST_ITEM_CLOSE"),_=w.getText("NOTIFICATION_LIST_GROUP_CLOSE");var b=s.extend("sap.m.NotificationListBase",{metadata:{library:"sap.m",properties:{priority:{type:"sap.ui.core.Priority",group:"Appearance",defaultValue:g.None},title:{type:"string",group:"Appearance",defaultValue:""},datetime:{type:"string",group:"Appearance",defaultValue:""},showButtons:{type:"boolean",group:"Behavior",defaultValue:true},showCloseButton:{type:"boolean",group:"Behavior",defaultValue:true},authorName:{type:"string",group:"Appearance",defaultValue:""},authorPicture:{type:"sap.ui.core.URI",multiple:false}},aggregations:{buttons:{type:"sap.m.Button",multiple:true},_overflowToolbar:{type:"sap.m.OverflowToolbar",multiple:false,visibility:"hidden"},_priorityIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"}},events:{close:{}}}});b.prototype._activeHandling=function(){};b.prototype.updateSelectedDOM=function(){};b.prototype.getAccessibilityText=function(){return""};b.prototype.getButtons=function(){return this._getOverflowToolbar().getContent().filter(function(t){return t!==this._closeButton&&t!==this._toolbarSeparator},this)};b.prototype.addButton=function(t){var e=this._getOverflowToolbar(),o=e.getContent().length;if(i.system.phone){o-=2}e.insertContent(t,o);this.invalidate();return this};b.prototype.insertButton=function(t,e){this._getOverflowToolbar().insertContent(t,e);this.invalidate();return this};b.prototype.removeButton=function(t){var e=this._getOverflowToolbar().removeContent(t.getId());this.invalidate();return e};b.prototype.removeAllButtons=function(){var t=this._getOverflowToolbar(),e=this.getButtons();e.forEach(function(e){t.removeContent(e.getId())});this.invalidate();return this};b.prototype.destroyButtons=function(){var t=this.getButtons();t.forEach(function(t){t.destroy()});this.invalidate();return this};b.prototype._getOverflowToolbar=function(){var t=this.getAggregation("_overflowToolbar");if(!t){t=new p(this.getId()+"-overflowToolbar",{});this.setAggregation("_overflowToolbar",t,true);if(i.system.phone){var e=this._getCloseButton();e.setLayoutData(new f({priority:d.AlwaysOverflow}));this._toolbarSeparator=new u;this._toolbarSeparator.setLayoutData(new f({priority:d.AlwaysOverflow}));t.addContent(this._toolbarSeparator);t.addContent(e)}}return t};b.prototype._getCloseButton=function(){var t=this._closeButton;if(!t){if(i.system.phone){this._closeButton=new l(this.getId()+"-closeButtonOverflow",{text:this.isA("sap.m.NotificationListItem")?B:_,type:v.Default,press:function(){this.close()}.bind(this)})}else{this._closeButton=new l(this.getId()+"-closeButtonX",{icon:h.getIconURI("decline"),type:v.Transparent,tooltip:this.isA("sap.m.NotificationListItem")?B:_,press:function(){this.close()}.bind(this)})}}return this._closeButton};b.prototype.exit=function(){if(this._closeButton){this._closeButton.destroy()}if(this._toolbarSeparator){this._toolbarSeparator.destroy()}};b.prototype._hasActionButtons=function(){return this.getShowButtons()&&this.getButtons().length};b.prototype._shouldRenderCloseButton=function(){return!i.system.phone&&this.getShowCloseButton()};b.prototype._shouldRenderOverflowToolbar=function(){var t=this._hasActionButtons();if(i.system.phone){return t||this.getShowCloseButton()}return t};b.prototype.onBeforeRendering=function(){var t=this.getButtons(),e,o;if(i.system.phone){this._updatePhoneButtons();return}e=t.length>1?d.AlwaysOverflow:d.NeverOverflow;for(var r=0;r<t.length;r++){o=t[r];o.setLayoutData(new f({priority:r===0?e:d.AlwaysOverflow}))}};b.prototype._updatePhoneButtons=function(){var t=this._getCloseButton(),e=this.isA("sap.m.NotificationListGroup"),o=e?_:B,r=e&&this.getCollapsed(),i=!r&&this._hasActionButtons(),s=this.getShowCloseButton(),n;this.getButtons().forEach(function(t){if(i){n=d.AlwaysOverflow;t.removeStyleClass("sapMNLIBHiddenButton")}else{n=d.NeverOverflow;t.addStyleClass("sapMNLIBHiddenButton")}t.setLayoutData(new f({priority:n}))});if(!s){t.setVisible(false);this._toolbarSeparator.setVisible(false);return}t.setVisible(true);if(i){t.setText(o);t.setTooltip("");t.setType(v.Default);t.setIcon("");t.setLayoutData(new f({priority:d.AlwaysOverflow}));this._toolbarSeparator.setVisible(true)}else{t.setText("");t.setTooltip(o);t.setType(v.Transparent);t.setIcon(h.getIconURI("decline"));t.setLayoutData(new f({priority:d.NeverOverflow}));this._toolbarSeparator.setVisible(false)}};b.prototype.close=function(){var t=this.getParent();this.fireClose();var e=!!this.getParent();if(!e&&t&&t instanceof r){var o={onAfterRendering:function(){t.focus();t.removeEventDelegate(o)}};t.addEventDelegate(o)}};b.prototype._getPriorityIcon=function(){var t=this.getAggregation("_priorityIcon");if(!t){t=new c({src:"sap-icon://message-error"});this.setAggregation("_priorityIcon",t,true)}return t};return b});