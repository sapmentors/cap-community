/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/support/library","./CoreHelper.support","sap/ui/thirdparty/jquery","sap/ui/dom/jquery/control"],function(e,t,s){"use strict";var o=sap.ui.require("sap/base/Log");if(!o){o=s.sap.log}var r=e.Categories;var i=e.Severity;var n=e.Audiences;var a={id:"errorLogs",audiences:[n.Control,n.Internal],categories:[r.Performance],enabled:true,minversion:"1.32",title:"Error logs",description:"Checks for the amount of error logs in the console",resolution:"Error logs should be fixed",resolutionurls:[],check:function(e,t){var s=0,r="";var n=o.getLogEntries();n.forEach(function(e){if(e.level===o.Level.ERROR){s++;if(s<=20){r+="- "+e.message+"\n"}}});if(s>0){e.addIssue({severity:i.Low,details:"Total error logs: "+s+"\n"+r,context:{id:"WEBPAGE"}})}}};var l={id:"cssCheckCustomStyles",audiences:[n.Application],categories:[r.Consistency],enabled:true,minversion:"1.38",title:"CSS modifications - List of custom styles",description:"Checks and report for custom CSS files/styles that overwrite standard UI5 control's CSS values ",resolution:"Avoid CSS manipulations with custom CSS values as this could lead to rendering issues ",resolutionurls:[{text:"CSS Styling Issues",href:"https://openui5.hana.ondemand.com/#docs/guide/9d87f925dfbb4e99b9e2963693aa00ef.html"},{text:"General Guidelines",href:"https://openui5.hana.ondemand.com/#docs/guide/5e08ff90b7434990bcb459513d8c52c4.html"}],check:function(e,s,o){var r="Following stylesheet file(s) contain 'custom' CSS that could affects (overwrites) UI5 controls' own styles: \n",n=t.getExternalStyleSheets(),a=0;n.forEach(function(e){var s=false;Array.from(e.rules).forEach(function(e){var r=e.selectorText,i=document.querySelectorAll(r);i.forEach(function(e){var r=t.nodeHasUI5ParentControl(e,o);if(r){s=true}})});if(s){r+="- "+t.getStyleSheetName(e)+"\n";a++}});if(a>0){e.addIssue({severity:i.Medium,details:r,context:{id:"WEBPAGE"}})}}};var c={id:"cssCheckCustomStylesThatAffectControls",audiences:[n.Application],categories:[r.Consistency],enabled:true,minversion:"1.38",title:"CSS modifications - List of affected controls",description:"Checks and report all overwritten standard control's CSS values ",resolution:"Avoid CSS manipulations with custom CSS values as this could lead to rendering issues ",resolutionurls:[{text:"CSS Styling Issues",href:"https://openui5.hana.ondemand.com/#docs/guide/9d87f925dfbb4e99b9e2963693aa00ef.html"},{text:"General Guidelines",href:"https://openui5.hana.ondemand.com/#docs/guide/5e08ff90b7434990bcb459513d8c52c4.html"}],check:function(e,o,r){var n={},a=t.getExternalStyleSheets();a.forEach(function(e){Array.from(e.rules).forEach(function(o){var i=o.selectorText,a=document.querySelectorAll(i);a.forEach(function(o){var a=t.nodeHasUI5ParentControl(o,r);if(a){var l=s(o).control()[0];if(!n.hasOwnProperty(l.getId())){n[l.getId()]=""}var c=t.getStyleSource(e);n[l.getId()]+="'"+i+"'"+" from "+c+",\n"}})})});Object.keys(n).forEach(function(t){e.addIssue({severity:i.Low,details:"The following selector(s) "+n[t]+" affects standard style setting for control",context:{id:t}})})}};var u={id:"eventBusSilentPublish",audiences:[n.Internal],categories:[r.Functionality],enabled:true,minversion:"1.32",title:"EventBus publish",description:"Checks the EventBus publications for missing listeners",resolution:"Calls to EventBus#publish should be removed or adapted such that associated listeners are found",resolutionurls:[],check:function(e,t){var s=o.getLogEntries();var r=[];s.forEach(function(e){if(e.component==="sap.ui.core.EventBus"){if(e.details&&e.details.indexOf("sap.")!==0){if(r.indexOf(e.message)===-1){r.push(e.message)}}}});r.forEach(function(t){e.addIssue({severity:i.Low,details:"EventBus publish without listeners "+t,context:{id:"WEBPAGE"}})})}};return[u,a,l,c]},true);